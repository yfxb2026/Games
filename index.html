<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>è½»æ¾åˆ†ç±»</title>

<style>
  :root{
    --bg:#fbfaf7;
    --ink:#1f2937;
    --muted:#6b7280;
    --card:#ffffff;
    --shadow:0 10px 30px rgba(0,0,0,.08);
    --border:rgba(0,0,0,.12);

    --cols:5;
    --gap:10px;

    --emoji:38px;
    --label:20px;
    --labelWeight:800;
    --radius:10px;
    --padY:8px;
    --padX:6px;

    --itemsMaxH: 62vh;

    --hitPad: 24px;

    /* âœ… ç¯®å­æ ‡é¢˜è¡Œï¼ˆè®©æç¤ºæ›´é†’ç›®ä½†ä¸è¿‡åˆ†ï¼‰ */
    --binTitle: 20px;
    --binHint: 16px;
    --binHintWeight: 700;
    --binHintColor: rgba(17,24,39,.72);
  }

  body.level-10{
    --cols:4;
    --gap:12px;
    --emoji:44px;
    --label:22px;
    --radius:12px;
    --padY:10px;
    --padX:8px;
    --itemsMaxH: 62vh;
    --hitPad: 28px;

    --binTitle: 21px;
    --binHint: 17px;
  }

  body.level-20{
    --cols:5;
    --gap:10px;
    --emoji:40px;
    --label:21px;
    --radius:10px;
    --padY:9px;
    --padX:7px;
    --itemsMaxH: 62vh;
    --hitPad: 26px;

    --binTitle: 20px;
    --binHint: 16px;
  }

  body.level-40{
    --cols:5;
    --gap:8px;
    --emoji:36px;
    --label:19px;
    --radius:9px;
    --padY:7px;
    --padX:6px;
    --itemsMaxH: 58vh;
    --hitPad: 24px;

    --binTitle: 19px;
    --binHint: 15px;
  }

  body{
    margin:0;
    font-family:-apple-system,BlinkMacSystemFont,"PingFang SC","Microsoft YaHei",sans-serif;
    background:var(--bg);
    color:var(--ink);
  }

  header{
    padding:16px;
    display:flex;
    flex-wrap:wrap;
    gap:12px;
    justify-content:space-between;
    align-items:flex-end;
  }
  h1{margin:0;font-size:26px;}
  p{margin:6px 0 0;color:var(--muted)}

  button,select{
    font-size:16px;
    padding:10px 14px;
    border-radius:14px;
    border:1px solid rgba(0,0,0,.15);
    background:#fff;
  }
  button{
    background:#111827;
    color:#fff;
    border:none;
  }
  button.secondary{
    background:#fff;
    color:#111827;
    border:1px solid rgba(0,0,0,.15);
  }

  main{
    padding:16px;
    max-width:980px;
    margin:auto;
  }

  .status{
    display:flex;
    gap:12px;
    flex-wrap:wrap;
    margin-bottom:12px;
  }
  .pill{
    padding:6px 12px;
    border-radius:999px;
    background:#fff;
    border:1px solid rgba(0,0,0,.1);
  }

  .grid{
    display:grid;
    grid-template-columns:1fr;
    gap:14px;
  }
  @media(min-width:760px){
    .grid{grid-template-columns:1.25fr .75fr;}
  }

  .items,.bins{
    background:var(--card);
    border-radius:18px;
    padding:14px;
    box-shadow:var(--shadow);
  }

  .itemsWrap{
    display:grid;
    grid-template-columns:repeat(var(--cols), 1fr);
    gap:var(--gap);

    max-height: var(--itemsMaxH);
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;

    padding-right:2px;
  }

  .itemsWrap::-webkit-scrollbar{ width: 8px; }
  .itemsWrap::-webkit-scrollbar-thumb{ background: rgba(0,0,0,.18); border-radius: 8px; }
  .itemsWrap::-webkit-scrollbar-track{ background: transparent; }

  .item{
    background:#fff;
    border:1px solid var(--border);
    border-radius:var(--radius);
    aspect-ratio: 1 / 1;
    padding:var(--padY) var(--padX);
    text-align:center;
    touch-action:none;
    user-select:none;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
  }

  .item .emoji{
    font-size:var(--emoji);
    line-height:1.05;
  }
  .item .label{
    font-size:var(--label);
    font-weight:var(--labelWeight);
    margin-top:5px;
    letter-spacing:.4px;
  }

  .item.placeholder{
    opacity:0;
    pointer-events:none;
  }

  .binsWrap{
    display:flex;
    flex-direction:column;
    gap:12px;
  }

  .bin{
    border:2px dashed rgba(0,0,0,.25);
    border-radius:18px;
    padding:14px;
    transition: transform .08s ease, background .08s ease, border-color .08s ease;
  }

  .bin.active{
    background:#f9fafb;
    border-color: rgba(17,24,39,.55);
    transform: scale(1.01);
  }

  /* âœ… æ ‡é¢˜ä¸æç¤ºåŒä¸€è¡Œ */
  .binTop{
    display:flex;
    align-items:baseline;
    justify-content:space-between;
    gap:10px;
    margin-bottom:4px;
  }

  .binName{
    font-size:var(--binTitle);
    font-weight:800;
    letter-spacing:.3px;
  }

  .binHintInline{
    font-size:var(--binHint);
    font-weight:var(--binHintWeight);
    color:var(--binHintColor);
    white-space:nowrap;
  }

  .binItems{
    display:flex;
    flex-wrap:wrap;
    gap:8px;
    margin-top:8px;
  }

  .chip{
    background:#111827;
    color:#fff;
    padding:6px 10px;
    border-radius:999px;
    font-size:15px;
  }

  .msg{
    margin-top:8px;
    font-size:18px;
    color:var(--muted);
    min-height:24px;
  }

  .drag-ghost{
    position:fixed;
    z-index:9999;
    pointer-events:none;
    opacity:.92;
    transform: scale(1.03);
    box-shadow: 0 18px 40px rgba(0,0,0,.18);
  }
</style>
</head>

<body class="level-20">

<header>
  <div>
    <h1>è½»æ¾åˆ†ç±»</h1>
    <p>æŠŠç‰©å“æ‹–åˆ°åˆé€‚çš„ç¯®å­é‡Œ</p>
  </div>

  <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center">
    <select id="levelSel" title="æ¯å±€ç‰©å“æ•°é‡">
      <option value="10">è½»æ¾ï¼ˆ10ï¼‰</option>
      <option value="20" selected>é€‚ä¸­ï¼ˆ20ï¼‰</option>
      <option value="40">ä¸°å¯Œï¼ˆ40ï¼‰</option>
    </select>
    <button id="btnNew">æ¢ä¸€ç»„</button>
    <button class="secondary" id="btnReset">æ¸…ç©º</button>
  </div>
</header>

<main>
  <div class="status">
    <div class="pill">å®Œæˆ <b id="done">0</b>/<b id="total">0</b></div>
    <div class="pill">å¾—åˆ† <b id="score">0</b></div>
  </div>

  <div class="msg" id="msg"></div>

  <div class="grid">
    <div class="items">
      <h3 style="margin:0 0 10px;">ç‰©å“</h3>
      <div class="itemsWrap" id="itemsWrap"></div>
    </div>

    <div class="bins">
      <h3 style="margin:0 0 10px;">ç¯®å­</h3>
      <div class="binsWrap" id="binsWrap"></div>
    </div>
  </div>
</main>

<script>
const SET = {
  bins:[
    {id:"food",title:"é£Ÿç‰©",hint:"èƒ½åƒçš„"},
    {id:"clothes",title:"è¡£ç‰©",hint:"ç©¿æˆ´çš„"},
    {id:"tools",title:"å·¥å…·",hint:"ç”¨æ¥åšäº‹"}
  ],
  items:[
    // é£Ÿç‰©
    {id:"food_apple",emoji:"ğŸ",label:"è‹¹æœ",cat:"food"},
    {id:"food_banana",emoji:"ğŸŒ",label:"é¦™è•‰",cat:"food"},
    {id:"food_orange",emoji:"ğŸŠ",label:"æ©™å­",cat:"food"},
    {id:"food_grapes",emoji:"ğŸ‡",label:"è‘¡è„",cat:"food"},
    {id:"food_watermelon",emoji:"ğŸ‰",label:"è¥¿ç“œ",cat:"food"},
    {id:"food_peach",emoji:"ğŸ‘",label:"æ¡ƒå­",cat:"food"},
    {id:"food_pear",emoji:"ğŸ",label:"æ¢¨",cat:"food"},
    {id:"food_strawberry",emoji:"ğŸ“",label:"è‰è“",cat:"food"},
    {id:"food_cherries",emoji:"ğŸ’",label:"æ¨±æ¡ƒ",cat:"food"},
    {id:"food_pineapple",emoji:"ğŸ",label:"è è",cat:"food"},
    {id:"food_lemon",emoji:"ğŸ‹",label:"æŸ æª¬",cat:"food"},
    {id:"food_kiwi",emoji:"ğŸ¥",label:"çŒ•çŒ´æ¡ƒ",cat:"food"},
    {id:"food_mango",emoji:"ğŸ¥­",label:"èŠ’æœ",cat:"food"},
    {id:"food_tomato",emoji:"ğŸ…",label:"ç•ªèŒ„",cat:"food"},
    {id:"food_carrot",emoji:"ğŸ¥•",label:"èƒ¡èåœ",cat:"food"},
    {id:"food_corn",emoji:"ğŸŒ½",label:"ç‰ç±³",cat:"food"},
    {id:"food_potato",emoji:"ğŸ¥”",label:"åœŸè±†",cat:"food"},
    {id:"food_mushroom",emoji:"ğŸ„",label:"è˜‘è‡",cat:"food"},
    {id:"food_bread",emoji:"ğŸ",label:"é¢åŒ…",cat:"food"},
    {id:"food_rice",emoji:"ğŸš",label:"ç±³é¥­",cat:"food"},
    {id:"food_noodle",emoji:"ğŸœ",label:"é¢æ¡",cat:"food"},
    {id:"food_dumpling",emoji:"ğŸ¥Ÿ",label:"é¥ºå­",cat:"food"},
    {id:"food_egg",emoji:"ğŸ¥š",label:"é¸¡è›‹",cat:"food"},
    {id:"food_fish",emoji:"ğŸŸ",label:"é±¼",cat:"food"},
    {id:"food_meat",emoji:"ğŸ–",label:"è‚‰",cat:"food"},
    {id:"food_milk",emoji:"ğŸ¥›",label:"ç‰›å¥¶",cat:"food"},
    {id:"food_cake",emoji:"ğŸ°",label:"è›‹ç³•",cat:"food"},
    {id:"food_icecream",emoji:"ğŸ¦",label:"å†°æ·‡æ·‹",cat:"food"},

    // è¡£ç‰©
    {id:"clo_shirt",emoji:"ğŸ‘•",label:"ä¸Šè¡£",cat:"clothes"},
    {id:"clo_pants",emoji:"ğŸ‘–",label:"è£¤å­",cat:"clothes"},
    {id:"clo_dress",emoji:"ğŸ‘—",label:"è£™å­",cat:"clothes"},
    {id:"clo_socks",emoji:"ğŸ§¦",label:"è¢œå­",cat:"clothes"},
    {id:"clo_hat",emoji:"ğŸ§¢",label:"å¸½å­",cat:"clothes"},
    {id:"clo_shoe",emoji:"ğŸ‘Ÿ",label:"é‹å­",cat:"clothes"},
    {id:"clo_boot",emoji:"ğŸ¥¾",label:"é´å­",cat:"clothes"},
    {id:"clo_sandal",emoji:"ğŸ©´",label:"æ‹–é‹",cat:"clothes"},
    {id:"clo_coat",emoji:"ğŸ§¥",label:"å¤–å¥—",cat:"clothes"},
    {id:"clo_gloves",emoji:"ğŸ§¤",label:"æ‰‹å¥—",cat:"clothes"},
    {id:"clo_scarf",emoji:"ğŸ§£",label:"å›´å·¾",cat:"clothes"},
    {id:"clo_tie",emoji:"ğŸ‘”",label:"é¢†å¸¦",cat:"clothes"},
    {id:"clo_backpack",emoji:"ğŸ’",label:"èƒŒåŒ…",cat:"clothes"},
    {id:"clo_umbrella",emoji:"â˜‚ï¸",label:"é›¨ä¼",cat:"clothes"},
    {id:"clo_watch",emoji:"âŒš",label:"æ‰‹è¡¨",cat:"clothes"},
    {id:"clo_glasses",emoji:"ğŸ‘“",label:"çœ¼é•œ",cat:"clothes"},
    {id:"clo_mask",emoji:"ğŸ˜·",label:"å£ç½©",cat:"clothes"},
    {id:"clo_ring",emoji:"ğŸ’",label:"æˆ’æŒ‡",cat:"clothes"},
    {id:"clo_cap2",emoji:"ğŸ©",label:"ç¤¼å¸½",cat:"clothes"},
    {id:"clo_bag",emoji:"ğŸ‘œ",label:"åŒ…",cat:"clothes"},

    // å·¥å…·
    {id:"tool_wrench",emoji:"ğŸ”§",label:"æ‰³æ‰‹",cat:"tools"},
    {id:"tool_hammer",emoji:"ğŸ”¨",label:"é”¤å­",cat:"tools"},
    {id:"tool_screwdriver",emoji:"ğŸª›",label:"èºä¸åˆ€",cat:"tools"},
    {id:"tool_saw",emoji:"ğŸªš",label:"é”¯å­",cat:"tools"},
    {id:"tool_scissors",emoji:"âœ‚ï¸",label:"å‰ªåˆ€",cat:"tools"},
    {id:"tool_broom",emoji:"ğŸ§¹",label:"æ‰«æŠŠ",cat:"tools"},
    {id:"tool_sponge",emoji:"ğŸ§½",label:"æŠ¹å¸ƒ",cat:"tools"},
    {id:"tool_bucket",emoji:"ğŸª£",label:"æ°´æ¡¶",cat:"tools"},
    {id:"tool_pan",emoji:"ğŸ³",label:"å¹³åº•é”…",cat:"tools"},
    {id:"tool_pot",emoji:"ğŸ²",label:"æ±¤é”…",cat:"tools"},
    {id:"tool_knife",emoji:"ğŸ”ª",label:"åˆ€",cat:"tools"},
    {id:"tool_spoon",emoji:"ğŸ¥„",label:"å‹ºå­",cat:"tools"},
    {id:"tool_fork",emoji:"ğŸ´",label:"å‰å­",cat:"tools"},
    {id:"tool_flashlight",emoji:"ğŸ”¦",label:"æ‰‹ç”µ",cat:"tools"},
    {id:"tool_plug",emoji:"ğŸ”Œ",label:"æ’å¤´",cat:"tools"},
    {id:"tool_key",emoji:"ğŸ”‘",label:"é’¥åŒ™",cat:"tools"},
    {id:"tool_lock",emoji:"ğŸ”’",label:"é”",cat:"tools"},
    {id:"tool_phone",emoji:"ğŸ“±",label:"æ‰‹æœº",cat:"tools"},
    {id:"tool_remote",emoji:"ğŸ“º",label:"é¥æ§å™¨",cat:"tools"},
    {id:"tool_book",emoji:"ğŸ“–",label:"ä¹¦",cat:"tools"},
    {id:"tool_pencil",emoji:"âœï¸",label:"é“…ç¬”",cat:"tools"},
    {id:"tool_ruler",emoji:"ğŸ“",label:"å°ºå­",cat:"tools"},
    {id:"tool_tape",emoji:"ğŸ§»",label:"çº¸å·¾",cat:"tools"},
    {id:"tool_bag",emoji:"ğŸ›ï¸",label:"è´­ç‰©è¢‹",cat:"tools"},
    {id:"tool_brush",emoji:"ğŸª¥",label:"ç‰™åˆ·",cat:"tools"},
    {id:"tool_lamp",emoji:"ğŸ’¡",label:"ç¯æ³¡",cat:"tools"}
  ]
};

let state={ level:20, score:0, placed:new Set(), binContents:{}, picked:[] };

const itemsWrap=document.getElementById("itemsWrap");
const binsWrap=document.getElementById("binsWrap");
const msg=document.getElementById("msg");
const levelSel=document.getElementById("levelSel");

function shuffle(a){
  const arr=a.slice();
  for(let i=arr.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]]=[arr[j],arr[i]];
  }
  return arr;
}

function applyLevelClass(){
  document.body.classList.remove("level-10","level-20","level-40");
  document.body.classList.add(`level-${state.level}`);
}

function newRound(){
  state.score=0;
  state.placed.clear();
  state.binContents={};
  applyLevelClass();

  state.picked = shuffle(SET.items).slice(0, Math.min(state.level, SET.items.length));
  render();
  msg.textContent="å¼€å§‹å§ ğŸ™‚";
}

function clearBinHighlights(){
  document.querySelectorAll(".bin.active").forEach(b=>b.classList.remove("active"));
}

function getHitRect(r, pad){
  return { left:r.left-pad, right:r.right+pad, top:r.top-pad, bottom:r.bottom+pad };
}

function findHitBin(x, y){
  const pad = parseInt(getComputedStyle(document.documentElement).getPropertyValue("--hitPad")) || 24;
  const bins = Array.from(document.querySelectorAll(".bin"));
  for(const b of bins){
    const r=b.getBoundingClientRect();
    const hr=getHitRect(r,pad);
    if(x>hr.left && x<hr.right && y>hr.top && y<hr.bottom) return b;
  }
  return null;
}

function render(){
  itemsWrap.innerHTML="";
  binsWrap.innerHTML="";

  state.picked.forEach(it=>{
    const div=document.createElement("div");
    if(state.placed.has(it.id)){
      div.className="item placeholder";
    }else{
      div.className="item";
      div.innerHTML=`<div class="emoji">${it.emoji}</div><div class="label">${it.label}</div>`;
      enableDrag(div,it);
    }
    itemsWrap.appendChild(div);
  });

  SET.bins.forEach(bin=>{
    const b=document.createElement("div");
    b.className="bin";
    b.dataset.id=bin.id;

    b.innerHTML=`
      <div class="binTop">
        <div class="binName">${bin.title}</div>
        <div class="binHintInline">${bin.hint}</div>
      </div>
      <div class="binItems"></div>
    `;

    (state.binContents[bin.id]||[]).forEach(it=>{
      const chip=document.createElement("div");
      chip.className="chip";
      chip.textContent=`${it.emoji} ${it.label}`;
      b.querySelector(".binItems").appendChild(chip);
    });

    binsWrap.appendChild(b);
  });

  document.getElementById("done").textContent=state.placed.size;
  document.getElementById("total").textContent=state.picked.length;
  document.getElementById("score").textContent=state.score;
}

function enableDrag(el,item){
  el.onpointerdown=e=>{
    el.setPointerCapture(e.pointerId);

    const r = el.getBoundingClientRect();

    const ghost=el.cloneNode(true);
    ghost.classList.add("drag-ghost");
    ghost.style.width = r.width + "px";
    ghost.style.height = r.height + "px";
    ghost.style.boxSizing = "border-box";
    document.body.appendChild(ghost);

    const offsetX = r.width * 0.15;
    const offsetY = r.height * 0.15;

    const moveGhost=(x,y)=>{
      ghost.style.left = (x - r.width/2 + offsetX) + "px";
      ghost.style.top  = (y - r.height/2 + offsetY) + "px";
    };
    moveGhost(e.clientX,e.clientY);

    let lastActive=null;

    document.onpointermove=ev=>{
      moveGhost(ev.clientX, ev.clientY);
      const hitBin=findHitBin(ev.clientX, ev.clientY);
      if(hitBin!==lastActive){
        clearBinHighlights();
        if(hitBin) hitBin.classList.add("active");
        lastActive=hitBin;
      }
    };

    document.onpointerup=ev=>{
      document.onpointermove=null;
      document.onpointerup=null;
      ghost.remove();

      const hitBin=findHitBin(ev.clientX, ev.clientY);
      clearBinHighlights();

      if(hitBin){
        if(hitBin.dataset.id===item.cat){
          state.placed.add(item.id);
          state.score++;
          state.binContents[hitBin.dataset.id] ??= [];
          state.binContents[hitBin.dataset.id].push(item);
          msg.textContent="å¯¹å•¦ï½";
          render();
          if(state.placed.size===state.picked.length){
            msg.textContent="è¿™ä¸€ç»„å®Œæˆå•¦ ğŸ‰ ç‚¹â€œæ¢ä¸€ç»„â€ç»§ç»­ã€‚";
          }
        }else{
          msg.textContent="æ¢ä¸ªç¯®å­è¯•è¯•ï½";
        }
      }else{
        msg.textContent="æ²¡å…³ç³»ï¼Œå†æ‹–ä¸€æ¬¡ï½";
      }
    };
  };
}

document.getElementById("btnNew").onclick=newRound;
document.getElementById("btnReset").onclick=newRound;

levelSel.onchange=e=>{
  state.level=Number(e.target.value);
  newRound();
};

state.level=Number(levelSel.value);
newRound();
</script>

</body>
</html>
