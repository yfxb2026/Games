<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ËΩªÊùæÂàÜÁ±ª</title>

<style>
  :root{
    --bg1:#fbf7ef;
    --bg2:#f3f7f2;

    --ink:#1f2937;
    --muted:#6b7280;

    --card:#fffdf8;
    --shadow:0 10px 26px rgba(17,24,39,.08);
    --border:rgba(17,24,39,.14);

    --cols:5;
    --gap:10px;

    --emoji:38px;
    --label:20px;
    --labelWeight:800;
    --radius:10px;
    --padY:8px;
    --padX:6px;

    --itemsMaxH: 66vh;

    --hitPad: 30px;
    --binMinH: 140px;

    --binTitle: 20px;
    --binHint: 16px;
    --binHintWeight: 700;
    --binHintColor: rgba(17,24,39,.72);

    --headerPadY: 10px;
    --headerPadX: 12px;
    --mainPad: 10px;

    --h1Size: 24px;

    --accent:#2f6f60;
    --accentSoft:rgba(47,111,96,.12);
  }

  body.level-10{
    --cols:4; --gap:12px; --emoji:44px; --label:22px; --radius:12px; --padY:10px; --padX:8px;
    --itemsMaxH: 66vh; --hitPad: 36px; --binMinH: 160px;
    --binTitle: 21px; --binHint: 17px; --h1Size: 25px;
  }
  body.level-20{
    --cols:5; --gap:10px; --emoji:40px; --label:21px; --radius:10px; --padY:9px; --padX:7px;
    --itemsMaxH: 66vh; --hitPad: 32px; --binMinH: 150px;
    --binTitle: 20px; --binHint: 16px; --h1Size: 24px;
  }
  body.level-40{
    --cols:5; --gap:8px; --emoji:36px; --label:19px; --radius:9px; --padY:7px; --padX:6px;
    --itemsMaxH: 62vh; --hitPad: 30px; --binMinH: 135px;
    --binTitle: 19px; --binHint: 15px; --h1Size: 23px;
  }

  body{
    margin:0;
    font-family:-apple-system,BlinkMacSystemFont,"PingFang SC","Microsoft YaHei",sans-serif;
    color:var(--ink);
    background:
      radial-gradient(900px 600px at 20% 10%, rgba(47,111,96,.10), transparent 55%),
      radial-gradient(900px 600px at 90% 30%, rgba(245,170,110,.12), transparent 55%),
      linear-gradient(180deg, var(--bg1), var(--bg2));
  }

  header{
    padding:var(--headerPadY) var(--headerPadX);
    display:grid;
    grid-template-columns: 1fr auto 1fr;
    align-items:center;
    column-gap:10px;
  }

  .brand h1{margin:0;font-size:var(--h1Size);}
  .brand p{margin:3px 0 0;color:var(--muted);font-size:13px;}

  .topStatus{
    justify-self:center;
    display:flex;
    gap:10px;
    align-items:center;
  }
  .pill{
    padding:6px 12px;
    border-radius:999px;
    background:rgba(255,255,255,.72);
    border:1px solid rgba(17,24,39,.12);
    font-size:15px;
    backdrop-filter: blur(6px);
    -webkit-backdrop-filter: blur(6px);
    white-space:nowrap;
  }

  .topControls{
    justify-self:end;
    display:flex;
    gap:8px;
    flex-wrap:wrap;
    align-items:center;
  }

  button,select{
    font-size:16px;
    padding:10px 14px;
    border-radius:14px;
    border:1px solid rgba(17,24,39,.18);
    background:rgba(255,255,255,.78);
    backdrop-filter: blur(6px);
    -webkit-backdrop-filter: blur(6px);
  }
  button{
    background:rgba(47,111,96,.92);
    color:#fff;
    border:none;
  }
  button:active{ transform: translateY(1px); }
  button.secondary{
    background:rgba(255,255,255,.82);
    color:var(--ink);
    border:1px solid rgba(17,24,39,.18);
  }

  main{
    padding:var(--mainPad) var(--headerPadX);
    max-width:980px;
    margin:auto;
  }

  .grid{
    display:grid;
    grid-template-columns:1fr;
    gap:12px;
  }
  @media(min-width:760px){
    .grid{grid-template-columns:1.25fr .75fr;}
  }

  .items,.bins{
    background:var(--card);
    border-radius:18px;
    padding:12px;
    box-shadow:var(--shadow);
    border:1px solid rgba(17,24,39,.08);
  }

  .panelTop{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:10px;
    margin:0 0 8px;
  }
  .panelTop h3{ margin:0; font-size:18px; }

  .scrollBtns{ display:flex; gap:8px; align-items:center; }
  .scrollBtn{
    background:rgba(255,255,255,.9);
    color:var(--ink);
    border:1px solid rgba(17,24,39,.16);
    padding:8px 10px;
    border-radius:12px;
    font-size:16px;
    line-height:1;
    min-width:56px;
  }

  .itemsWrap{
    display:grid;
    grid-template-columns:repeat(var(--cols), 1fr);
    gap:var(--gap);
    max-height: var(--itemsMaxH);
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    padding-right:2px;
    touch-action: pan-y;
  }
  .itemsWrap::-webkit-scrollbar{ width: 8px; }
  .itemsWrap::-webkit-scrollbar-thumb{ background: rgba(17,24,39,.18); border-radius: 8px; }
  .itemsWrap::-webkit-scrollbar-track{ background: transparent; }

  .item{
    background:rgba(255,255,255,.92);
    border:1px solid rgba(17,24,39,.14);
    border-radius:var(--radius);
    aspect-ratio: 1 / 1;
    padding:var(--padY) var(--padX);
    text-align:center;
    touch-action:none;
    user-select:none;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
  }
  .item .emoji{ font-size:var(--emoji); line-height:1.05; }
  .item .label{ font-size:var(--label); font-weight:var(--labelWeight); margin-top:5px; letter-spacing:.4px; }
  .item.placeholder{ opacity:0; pointer-events:none; }

  .binsWrap{ display:flex; flex-direction:column; gap:12px; }

  .bin{
    border:2px dashed rgba(17,24,39,.22);
    border-radius:18px;
    padding:14px;
    min-height: var(--binMinH);
    box-sizing:border-box;
    transition: transform .08s ease, background .08s ease, border-color .08s ease;
    background: rgba(255,255,255,.55);
  }
  .bin.active{
    background: var(--accentSoft);
    border-color: rgba(47,111,96,.55);
    transform: scale(1.01);
  }

  .binTop{
    display:flex;
    align-items:baseline;
    justify-content:space-between;
    gap:10px;
    margin-bottom:6px;
  }
  .binName{ font-size:var(--binTitle); font-weight:800; letter-spacing:.3px; }
  .binHintInline{ font-size:var(--binHint); font-weight:700; color:var(--binHintColor); white-space:nowrap; }

  .binItems{
    display:flex;
    flex-wrap:wrap;
    gap:8px;
    margin-top:8px;
    min-height: 34px;
  }
  .chip{
    background:rgba(47,111,96,.92);
    color:#fff;
    padding:6px 10px;
    border-radius:999px;
    font-size:15px;
  }

  .msg{
    margin:6px 0 10px;
    font-size:18px;
    color:rgba(31,41,55,.70);
    min-height:22px;
  }

  .drag-ghost{
    position:fixed;
    z-index:9999;
    pointer-events:none;
    opacity:.92;
    transform: scale(1.03);
    box-shadow: 0 18px 40px rgba(0,0,0,.18);
  }
</style>
</head>

<body class="level-20">

<header>
  <div class="brand">
    <h1>ËΩªÊùæÂàÜÁ±ª</h1>
    <p>ÊääÁâ©ÂìÅÊãñÂà∞ÂêàÈÄÇÁöÑÁØÆÂ≠êÈáå</p>
  </div>

  <div class="topStatus">
    <div class="pill">ÂÆåÊàê <b id="done">0</b>/<b id="total">0</b></div>
    <div class="pill">ÂæóÂàÜ <b id="score">0</b></div>
  </div>

  <div class="topControls">
    <select id="levelSel" title="ÊØèÂ±ÄÁâ©ÂìÅÊï∞Èáè">
      <option value="10">ËΩªÊùæÔºà10Ôºâ</option>
      <option value="20" selected>ÈÄÇ‰∏≠Ôºà20Ôºâ</option>
      <option value="40">‰∏∞ÂØåÔºà40Ôºâ</option>
    </select>
    <button id="btnNew">Êç¢‰∏ÄÁªÑ</button>
    <button class="secondary" id="btnReset">Ê∏ÖÁ©∫</button>
  </div>
</header>

<main>
  <div class="msg" id="msg"></div>

  <div class="grid">
    <div class="items">
      <div class="panelTop">
        <h3>Áâ©ÂìÅ</h3>
        <div class="scrollBtns">
          <button class="scrollBtn" id="btnUp" type="button">‚¨ÜÔ∏é ‰∏äÁøª</button>
          <button class="scrollBtn" id="btnDown" type="button">‚¨áÔ∏é ‰∏ãÁøª</button>
        </div>
      </div>
      <div class="itemsWrap" id="itemsWrap"></div>
    </div>

    <div class="bins">
      <div class="panelTop">
        <h3>ÁØÆÂ≠ê</h3>
        <div style="width:140px"></div>
      </div>
      <div class="binsWrap" id="binsWrap"></div>
    </div>
  </div>
</main>

<script>
const SET = {
  bins:[
    {id:"food",title:"È£üÁâ©",hint:"ËÉΩÂêÉÁöÑ"},
    {id:"clothes",title:"Ë°£Áâ©",hint:"Á©øÊà¥ÁöÑ"},
    {id:"tools",title:"Â∑•ÂÖ∑",hint:"Áî®Êù•ÂÅö‰∫ã"}
  ],
  items:[
    // È£üÁâ©
    {id:"food_apple",emoji:"üçé",label:"ËãπÊûú",cat:"food"},
    {id:"food_banana",emoji:"üçå",label:"È¶ôËïâ",cat:"food"},
    {id:"food_orange",emoji:"üçä",label:"Ê©ôÂ≠ê",cat:"food"},
    {id:"food_grapes",emoji:"üçá",label:"Ëë°ËêÑ",cat:"food"},
    {id:"food_watermelon",emoji:"üçâ",label:"Ë•øÁìú",cat:"food"},
    {id:"food_peach",emoji:"üçë",label:"Ê°ÉÂ≠ê",cat:"food"},
    {id:"food_pear",emoji:"üçê",label:"Ê¢®",cat:"food"},
    {id:"food_strawberry",emoji:"üçì",label:"ËçâËéì",cat:"food"},
    {id:"food_cherries",emoji:"üçí",label:"Ê®±Ê°É",cat:"food"},
    {id:"food_pineapple",emoji:"üçç",label:"Ëè†Ëêù",cat:"food"},
    {id:"food_lemon",emoji:"üçã",label:"Êü†Ê™¨",cat:"food"},
    {id:"food_kiwi",emoji:"ü•ù",label:"ÁåïÁå¥Ê°É",cat:"food"},
    {id:"food_mango",emoji:"ü•≠",label:"ËäíÊûú",cat:"food"},
    {id:"food_tomato",emoji:"üçÖ",label:"Áï™ËåÑ",cat:"food"},
    {id:"food_carrot",emoji:"ü•ï",label:"ËÉ°ËêùÂçú",cat:"food"},
    {id:"food_corn",emoji:"üåΩ",label:"ÁéâÁ±≥",cat:"food"},
    {id:"food_potato",emoji:"ü•î",label:"ÂúüË±Ü",cat:"food"},
    {id:"food_mushroom",emoji:"üçÑ",label:"ËòëËèá",cat:"food"},
    {id:"food_bread",emoji:"üçû",label:"Èù¢ÂåÖ",cat:"food"},
    {id:"food_rice",emoji:"üçö",label:"Á±≥È•≠",cat:"food"},
    {id:"food_noodle",emoji:"üçú",label:"Èù¢Êù°",cat:"food"},
    {id:"food_dumpling",emoji:"ü•ü",label:"È•∫Â≠ê",cat:"food"},
    {id:"food_egg",emoji:"ü•ö",label:"È∏°Ëõã",cat:"food"},
    {id:"food_fish",emoji:"üêü",label:"È±º",cat:"food"},
    {id:"food_meat",emoji:"üçñ",label:"ËÇâ",cat:"food"},
    {id:"food_milk",emoji:"ü•õ",label:"ÁâõÂ•∂",cat:"food"},
    {id:"food_cake",emoji:"üç∞",label:"ËõãÁ≥ï",cat:"food"},
    {id:"food_icecream",emoji:"üç¶",label:"ÂÜ∞Ê∑áÊ∑ã",cat:"food"},

    // Ë°£Áâ©
    {id:"clo_shirt",emoji:"üëï",label:"‰∏äË°£",cat:"clothes"},
    {id:"clo_pants",emoji:"üëñ",label:"Ë£§Â≠ê",cat:"clothes"},
    {id:"clo_dress",emoji:"üëó",label:"Ë£ôÂ≠ê",cat:"clothes"},
    {id:"clo_socks",emoji:"üß¶",label:"Ë¢úÂ≠ê",cat:"clothes"},
    {id:"clo_hat",emoji:"üß¢",label:"Â∏ΩÂ≠ê",cat:"clothes"},
    {id:"clo_shoe",emoji:"üëü",label:"ÈûãÂ≠ê",cat:"clothes"},
    {id:"clo_boot",emoji:"ü•æ",label:"Èù¥Â≠ê",cat:"clothes"},
    {id:"clo_sandal",emoji:"ü©¥",label:"ÊãñÈûã",cat:"clothes"},
    {id:"clo_coat",emoji:"üß•",label:"Â§ñÂ•ó",cat:"clothes"},
    {id:"clo_gloves",emoji:"üß§",label:"ÊâãÂ•ó",cat:"clothes"},
    {id:"clo_scarf",emoji:"üß£",label:"Âõ¥Â∑æ",cat:"clothes"},
    {id:"clo_tie",emoji:"üëî",label:"È¢ÜÂ∏¶",cat:"clothes"},
    {id:"clo_backpack",emoji:"üéí",label:"ËÉåÂåÖ",cat:"clothes"},
    {id:"clo_umbrella",emoji:"‚òÇÔ∏è",label:"Èõ®‰ºû",cat:"clothes"},
    {id:"clo_watch",emoji:"‚åö",label:"ÊâãË°®",cat:"clothes"},
    {id:"clo_glasses",emoji:"üëì",label:"ÁúºÈïú",cat:"clothes"},
    {id:"clo_mask",emoji:"üò∑",label:"Âè£ÁΩ©",cat:"clothes"},
    {id:"clo_ring",emoji:"üíç",label:"ÊàíÊåá",cat:"clothes"},
    {id:"clo_cap2",emoji:"üé©",label:"Á§ºÂ∏Ω",cat:"clothes"},
    {id:"clo_bag",emoji:"üëú",label:"ÂåÖ",cat:"clothes"},

    // Â∑•ÂÖ∑
    {id:"tool_wrench",emoji:"üîß",label:"Êâ≥Êâã",cat:"tools"},
    {id:"tool_hammer",emoji:"üî®",label:"Èî§Â≠ê",cat:"tools"},
    {id:"tool_screwdriver",emoji:"ü™õ",label:"Ëû∫‰∏ùÂàÄ",cat:"tools"},
    {id:"tool_saw",emoji:"ü™ö",label:"ÈîØÂ≠ê",cat:"tools"},
    {id:"tool_scissors",emoji:"‚úÇÔ∏è",label:"Ââ™ÂàÄ",cat:"tools"},
    {id:"tool_broom",emoji:"üßπ",label:"Êâ´Êää",cat:"tools"},
    {id:"tool_sponge",emoji:"üßΩ",label:"ÊäπÂ∏É",cat:"tools"},
    {id:"tool_bucket",emoji:"ü™£",label:"Ê∞¥Ê°∂",cat:"tools"},
    {id:"tool_pan",emoji:"üç≥",label:"Âπ≥Â∫ïÈîÖ",cat:"tools"},
    {id:"tool_pot",emoji:"üç≤",label:"Ê±§ÈîÖ",cat:"tools"},
    {id:"tool_knife",emoji:"üî™",label:"ÂàÄ",cat:"tools"},
    {id:"tool_spoon",emoji:"ü•Ñ",label:"Âã∫Â≠ê",cat:"tools"},
    {id:"tool_fork",emoji:"üç¥",label:"ÂèâÂ≠ê",cat:"tools"},
    {id:"tool_flashlight",emoji:"üî¶",label:"ÊâãÁîµ",cat:"tools"},
    {id:"tool_plug",emoji:"üîå",label:"ÊèíÂ§¥",cat:"tools"},
    {id:"tool_key",emoji:"üîë",label:"Èí•Âåô",cat:"tools"},
    {id:"tool_lock",emoji:"üîí",label:"ÈîÅ",cat:"tools"},
    {id:"tool_phone",emoji:"üì±",label:"ÊâãÊú∫",cat:"tools"},
    {id:"tool_remote",emoji:"üì∫",label:"ÈÅ•ÊéßÂô®",cat:"tools"},
    {id:"tool_book",emoji:"üìñ",label:"‰π¶",cat:"tools"},
    {id:"tool_pencil",emoji:"‚úèÔ∏è",label:"ÈìÖÁ¨î",cat:"tools"},
    {id:"tool_ruler",emoji:"üìè",label:"Â∞∫Â≠ê",cat:"tools"},
    {id:"tool_tape",emoji:"üßª",label:"Á∫∏Â∑æ",cat:"tools"},
    {id:"tool_bag",emoji:"üõçÔ∏è",label:"Ë¥≠Áâ©Ë¢ã",cat:"tools"},
    {id:"tool_brush",emoji:"ü™•",label:"ÁâôÂà∑",cat:"tools"},
    {id:"tool_lamp",emoji:"üí°",label:"ÁÅØÊ≥°",cat:"tools"}
  ]
};

let state={ level:20, score:0, placed:new Set(), binContents:{}, picked:[] };

const itemsWrap=document.getElementById("itemsWrap");
const binsWrap=document.getElementById("binsWrap");
const msg=document.getElementById("msg");
const levelSel=document.getElementById("levelSel");

function shuffle(a){
  const arr=a.slice();
  for(let i=arr.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]]=[arr[j],arr[i]];
  }
  return arr;
}

/* ‚úÖ Êñ∞ÔºöÊåâÁ±ªÂà´Â∞ΩÈáèÂùáË°°ÊäΩÈ¢ò
   - base = floor(n/3)
   - rem = n%3
   - ‰ΩôÊï∞ÈöèÊú∫ÂàÜÈÖçÁªôÊüê‰∫õÁ±ªÂà´ÔºåÈÅøÂÖçÊÄªÊòØÂõ∫ÂÆöÂì™‰∏ÄÁ±ªÊõ¥Â§ö */
function pickBalanced(n){
  const cats = SET.bins.map(b=>b.id); // ["food","clothes","tools"]
  const poolByCat = {};
  cats.forEach(c=>{
    poolByCat[c] = shuffle(SET.items.filter(it=>it.cat===c));
  });

  const base = Math.floor(n / cats.length);
  const rem = n % cats.length;

  // ÊØèÁ±ªÂÖàÊãø base
  const want = {};
  cats.forEach(c=> want[c]=base);

  // ‰ΩôÊï∞ÂàÜÈÖçÔºöÈöèÊú∫Êåë rem ‰∏™Á±ªÂà´ÂêÑ+1
  const remCats = shuffle(cats).slice(0, rem);
  remCats.forEach(c=> want[c] += 1);

  // Â¶ÇÊûúÊüê‰∏ÄÁ±ªÂ∫ìÂ≠ò‰∏çÂ§üÔºàÁêÜËÆ∫‰∏ä‰∏ç‰ºöÔºâÔºåÂ∞±ÊääÁº∫Âè£Êå™ÁªôÂà´ÁöÑÁ±ª
  let picked = [];
  let short = 0;
  cats.forEach(c=>{
    const take = Math.min(want[c], poolByCat[c].length);
    picked = picked.concat(poolByCat[c].slice(0, take));
    short += (want[c] - take);
  });

  // ÊääÁº∫Âè£‰ªé‚ÄúËøòÊúâ‰ΩôÈáè‚ÄùÁöÑÁ±ªÂà´ÈáåË°•ÈΩê
  if(short > 0){
    const leftovers = [];
    cats.forEach(c=>{
      const take = Math.min(want[c], poolByCat[c].length);
      leftovers.push(...poolByCat[c].slice(take));
    });
    picked = picked.concat(leftovers.slice(0, short));
  }

  // ÊúÄÂêéÊï¥‰ΩìÂÜçÊ¥óÁâåÔºåËÆ©È°∫Â∫èÊ∑∑Âêà
  return shuffle(picked).slice(0, n);
}

function applyLevelClass(){
  document.body.classList.remove("level-10","level-20","level-40");
  document.body.classList.add(`level-${state.level}`);
}

function newRound(){
  state.score=0;
  state.placed.clear();
  state.binContents={};
  applyLevelClass();

  // ‚úÖ ËøôÈáåÊîπÊàê‚ÄúÂùáË°°Âá∫È¢ò‚Äù
  const n = Math.min(state.level, SET.items.length);
  state.picked = pickBalanced(n);

  render();
  msg.textContent="ÂºÄÂßãÂêß üôÇ";
}

function clearBinHighlights(){
  document.querySelectorAll(".bin.active").forEach(b=>b.classList.remove("active"));
}

function getHitRect(r, pad){
  return { left:r.left-pad, right:r.right+pad, top:r.top-pad, bottom:r.bottom+pad };
}

function findHitBin(x, y){
  const pad = parseInt(getComputedStyle(document.documentElement).getPropertyValue("--hitPad")) || 30;
  const bins = Array.from(document.querySelectorAll(".bin"));
  for(const b of bins){
    const r=b.getBoundingClientRect();
    const hr=getHitRect(r,pad);
    if(x>hr.left && x<hr.right && y>hr.top && y<hr.bottom) return b;
  }
  return null;
}

function render(){
  itemsWrap.innerHTML="";
  binsWrap.innerHTML="";

  state.picked.forEach(it=>{
    const div=document.createElement("div");
    if(state.placed.has(it.id)){
      div.className="item placeholder";
    }else{
      div.className="item";
      div.innerHTML=`<div class="emoji">${it.emoji}</div><div class="label">${it.label}</div>`;
      enableDrag(div,it);
    }
    itemsWrap.appendChild(div);
  });

  SET.bins.forEach(bin=>{
    const b=document.createElement("div");
    b.className="bin";
    b.dataset.id=bin.id;

    b.innerHTML=`
      <div class="binTop">
        <div class="binName">${bin.title}</div>
        <div class="binHintInline">${bin.hint}</div>
      </div>
      <div class="binItems"></div>
    `;

    (state.binContents[bin.id]||[]).forEach(it=>{
      const chip=document.createElement("div");
      chip.className="chip";
      chip.textContent=`${it.emoji} ${it.label}`;
      b.querySelector(".binItems").appendChild(chip);
    });

    binsWrap.appendChild(b);
  });

  document.getElementById("done").textContent=state.placed.size;
  document.getElementById("total").textContent=state.picked.length;
  document.getElementById("score").textContent=state.score;
}

function enableDrag(el,item){
  el.onpointerdown=e=>{
    el.setPointerCapture(e.pointerId);

    const r = el.getBoundingClientRect();
    const ghost=el.cloneNode(true);
    ghost.classList.add("drag-ghost");
    ghost.style.width = r.width + "px";
    ghost.style.height = r.height + "px";
    ghost.style.boxSizing = "border-box";
    document.body.appendChild(ghost);

    const offsetX = r.width * 0.15;
    const offsetY = r.height * 0.15;

    const moveGhost=(x,y)=>{
      ghost.style.left = (x - r.width/2 + offsetX) + "px";
      ghost.style.top  = (y - r.height/2 + offsetY) + "px";
    };
    moveGhost(e.clientX,e.clientY);

    let lastActive=null;

    document.onpointermove=ev=>{
      moveGhost(ev.clientX, ev.clientY);
      const hitBin=findHitBin(ev.clientX, ev.clientY);
      if(hitBin!==lastActive){
        clearBinHighlights();
        if(hitBin) hitBin.classList.add("active");
        lastActive=hitBin;
      }
    };

    document.onpointerup=ev=>{
      document.onpointermove=null;
      document.onpointerup=null;
      ghost.remove();

      const hitBin=findHitBin(ev.clientX, ev.clientY);
      clearBinHighlights();

      if(hitBin){
        if(hitBin.dataset.id===item.cat){
          state.placed.add(item.id);
          state.score++;
          state.binContents[hitBin.dataset.id] ??= [];
          state.binContents[hitBin.dataset.id].push(item);
          msg.textContent="ÂØπÂï¶ÔΩû";
          render();
          if(state.placed.size===state.picked.length){
            msg.textContent="Ëøô‰∏ÄÁªÑÂÆåÊàêÂï¶ üéâ ÁÇπ‚ÄúÊç¢‰∏ÄÁªÑ‚ÄùÁªßÁª≠„ÄÇ";
          }
        }else{
          msg.textContent="Êç¢‰∏™ÁØÆÂ≠êËØïËØïÔΩû";
        }
      }else{
        msg.textContent="Ê≤°ÂÖ≥Á≥ªÔºåÂÜçÊãñ‰∏ÄÊ¨°ÔΩû";
      }
    };
  };
}

function scrollItems(delta){
  const h = Math.max(120, Math.floor(itemsWrap.clientHeight * 0.85));
  itemsWrap.scrollBy({ top: delta * h, behavior: "smooth" });
}
document.getElementById("btnUp").onclick = ()=>scrollItems(-1);
document.getElementById("btnDown").onclick = ()=>scrollItems(1);

document.getElementById("btnNew").onclick=newRound;
document.getElementById("btnReset").onclick=newRound;

levelSel.onchange=e=>{
  state.level=Number(e.target.value);
  newRound();
};

state.level=Number(levelSel.value);
newRound();
</script>

</body>
</html>
