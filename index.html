<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>è½»æ¾åˆ†ç±»</title>

<style>
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"PingFang SC","Microsoft YaHei",sans-serif;
  background:#fbfaf7;
  color:#1f2937;
}
header{
  padding:16px;
  display:flex;
  flex-wrap:wrap;
  gap:12px;
  justify-content:space-between;
}
h1{margin:0;font-size:26px;}
p{margin:6px 0 0;color:#6b7280}

button,select{
  font-size:16px;
  padding:10px 14px;
  border-radius:14px;
  border:1px solid rgba(0,0,0,.15);
  background:#fff;
}
button{
  background:#111827;
  color:#fff;
  border:none;
}
button.secondary{
  background:#fff;
  color:#111827;
  border:1px solid rgba(0,0,0,.15);
}

main{
  padding:16px;
  max-width:980px;
  margin:auto;
}

.status{
  display:flex;
  gap:12px;
  flex-wrap:wrap;
  margin-bottom:12px;
}
.pill{
  padding:6px 12px;
  border-radius:999px;
  background:#fff;
  border:1px solid rgba(0,0,0,.1);
}

.grid{
  display:grid;
  grid-template-columns:1fr;
  gap:14px;
}
@media(min-width:760px){
  .grid{grid-template-columns:1.2fr .8fr;}
}

.items,.bins{
  background:#fff;
  border-radius:18px;
  padding:14px;
  box-shadow:0 10px 30px rgba(0,0,0,.08);
}

.itemsWrap{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:12px;
}
@media(min-width:760px){
  .itemsWrap{grid-template-columns:repeat(5,1fr);}
}

.item{
  background:#fff;
  border:1px solid rgba(0,0,0,.12);
  border-radius:16px;
  padding:10px 8px;
  text-align:center;
  touch-action:none;
  user-select:none;
}
.item .emoji{font-size:34px; line-height:1.1;}
.item .label{font-size:16px; margin-top:4px;}

.item.placeholder{
  opacity:0;
  pointer-events:none;
}

.binsWrap{
  display:flex;
  flex-direction:column;
  gap:12px;
}

.bin{
  border:2px dashed rgba(0,0,0,.25);
  border-radius:18px;
  padding:14px;
}
.bin.active{
  background:#f9fafb;
}

.binName{font-size:20px;font-weight:600}
.binHint{font-size:14px;color:#6b7280}

.binItems{
  display:flex;
  flex-wrap:wrap;
  gap:8px;
  margin-top:10px;
}

.chip{
  background:#111827;
  color:#fff;
  padding:6px 10px;
  border-radius:999px;
  font-size:15px;
}

.msg{
  margin-top:8px;
  font-size:18px;
  color:#6b7280;
  min-height: 24px;
}
</style>
</head>

<body>

<header>
  <div>
    <h1>è½»æ¾åˆ†ç±»</h1>
    <p>æŠŠç‰©å“æ‹–åˆ°åˆé€‚çš„ç¯®å­é‡Œ</p>
  </div>

  <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center">
    <select id="levelSel" title="æ¯å±€ç‰©å“æ•°é‡">
      <option value="10">è½»æ¾ï¼ˆ10ï¼‰</option>
      <option value="20" selected>é€‚ä¸­ï¼ˆ20ï¼‰</option>
      <option value="40">ä¸°å¯Œï¼ˆ40ï¼‰</option>
    </select>
    <button id="btnNew">æ¢ä¸€ç»„</button>
    <button class="secondary" id="btnReset">æ¸…ç©º</button>
  </div>
</header>

<main>
  <div class="status">
    <div class="pill">å®Œæˆ <b id="done">0</b>/<b id="total">0</b></div>
    <div class="pill">å¾—åˆ† <b id="score">0</b></div>
  </div>

  <div class="msg" id="msg"></div>

  <div class="grid">
    <div class="items">
      <h3 style="margin:0 0 10px;">ç‰©å“</h3>
      <div class="itemsWrap" id="itemsWrap"></div>
    </div>

    <div class="bins">
      <h3 style="margin:0 0 10px;">ç¯®å­</h3>
      <div class="binsWrap" id="binsWrap"></div>
    </div>
  </div>
</main>

<script>
/**
 * ä¸‰ç±»ä¸å˜ï¼šfood / clothes / tools
 * ä½ ä»¥åè¦åŠ ç‰©å“ï¼Œå°±ç»§ç»­å¾€ items æ•°ç»„é‡Œè¿½åŠ å³å¯ï¼ˆid ä¸é‡å¤å°±è¡Œï¼‰
 */
const SET = {
  bins:[
    {id:"food",title:"é£Ÿç‰©",hint:"èƒ½åƒçš„"},
    {id:"clothes",title:"è¡£ç‰©",hint:"ç©¿æˆ´çš„"},
    {id:"tools",title:"å·¥å…·",hint:"ç”¨æ¥åšäº‹"}
  ],
  items:[
    // é£Ÿç‰© foodï¼ˆå°½é‡å¤šæ ·ï¼‰
    {id:"food_apple",emoji:"ğŸ",label:"è‹¹æœ",cat:"food"},
    {id:"food_banana",emoji:"ğŸŒ",label:"é¦™è•‰",cat:"food"},
    {id:"food_orange",emoji:"ğŸŠ",label:"æ©™å­",cat:"food"},
    {id:"food_grapes",emoji:"ğŸ‡",label:"è‘¡è„",cat:"food"},
    {id:"food_watermelon",emoji:"ğŸ‰",label:"è¥¿ç“œ",cat:"food"},
    {id:"food_peach",emoji:"ğŸ‘",label:"æ¡ƒå­",cat:"food"},
    {id:"food_pear",emoji:"ğŸ",label:"æ¢¨",cat:"food"},
    {id:"food_strawberry",emoji:"ğŸ“",label:"è‰è“",cat:"food"},
    {id:"food_cherries",emoji:"ğŸ’",label:"æ¨±æ¡ƒ",cat:"food"},
    {id:"food_pineapple",emoji:"ğŸ",label:"è è",cat:"food"},
    {id:"food_lemon",emoji:"ğŸ‹",label:"æŸ æª¬",cat:"food"},
    {id:"food_kiwi",emoji:"ğŸ¥",label:"çŒ•çŒ´æ¡ƒ",cat:"food"},
    {id:"food_mango",emoji:"ğŸ¥­",label:"èŠ’æœ",cat:"food"},
    {id:"food_tomato",emoji:"ğŸ…",label:"ç•ªèŒ„",cat:"food"},
    {id:"food_carrot",emoji:"ğŸ¥•",label:"èƒ¡èåœ",cat:"food"},
    {id:"food_corn",emoji:"ğŸŒ½",label:"ç‰ç±³",cat:"food"},
    {id:"food_potato",emoji:"ğŸ¥”",label:"åœŸè±†",cat:"food"},
    {id:"food_mushroom",emoji:"ğŸ„",label:"è˜‘è‡",cat:"food"},
    {id:"food_bread",emoji:"ğŸ",label:"é¢åŒ…",cat:"food"},
    {id:"food_rice",emoji:"ğŸš",label:"ç±³é¥­",cat:"food"},
    {id:"food_noodle",emoji:"ğŸœ",label:"é¢æ¡",cat:"food"},
    {id:"food_dumpling",emoji:"ğŸ¥Ÿ",label:"é¥ºå­",cat:"food"},
    {id:"food_egg",emoji:"ğŸ¥š",label:"é¸¡è›‹",cat:"food"},
    {id:"food_fish",emoji:"ğŸŸ",label:"é±¼",cat:"food"},
    {id:"food_meat",emoji:"ğŸ–",label:"è‚‰",cat:"food"},
    {id:"food_milk",emoji:"ğŸ¥›",label:"ç‰›å¥¶",cat:"food"},
    {id:"food_coffee",emoji:"â˜•",label:"å’–å•¡",cat:"food"},

    // è¡£ç‰© clothes
    {id:"clo_shirt",emoji:"ğŸ‘•",label:"ä¸Šè¡£",cat:"clothes"},
    {id:"clo_pants",emoji:"ğŸ‘–",label:"è£¤å­",cat:"clothes"},
    {id:"clo_dress",emoji:"ğŸ‘—",label:"è£™å­",cat:"clothes"},
    {id:"clo_socks",emoji:"ğŸ§¦",label:"è¢œå­",cat:"clothes"},
    {id:"clo_hat",emoji:"ğŸ§¢",label:"å¸½å­",cat:"clothes"},
    {id:"clo_shoe",emoji:"ğŸ‘Ÿ",label:"é‹å­",cat:"clothes"},
    {id:"clo_boot",emoji:"ğŸ¥¾",label:"é´å­",cat:"clothes"},
    {id:"clo_sandal",emoji:"ğŸ©´",label:"æ‹–é‹",cat:"clothes"},
    {id:"clo_coat",emoji:"ğŸ§¥",label:"å¤–å¥—",cat:"clothes"},
    {id:"clo_gloves",emoji:"ğŸ§¤",label:"æ‰‹å¥—",cat:"clothes"},
    {id:"clo_scarf",emoji:"ğŸ§£",label:"å›´å·¾",cat:"clothes"},
    {id:"clo_tie",emoji:"ğŸ‘”",label:"é¢†å¸¦",cat:"clothes"},
    {id:"clo_belt",emoji:"ğŸ§·",label:"åˆ«é’ˆ",cat:"clothes"},
    {id:"clo_backpack",emoji:"ğŸ’",label:"èƒŒåŒ…",cat:"clothes"},
    {id:"clo_umbrella",emoji:"â˜‚ï¸",label:"é›¨ä¼",cat:"clothes"},
    {id:"clo_ring",emoji:"ğŸ’",label:"æˆ’æŒ‡",cat:"clothes"},
    {id:"clo_watch",emoji:"âŒš",label:"æ‰‹è¡¨",cat:"clothes"},
    {id:"clo_glasses",emoji:"ğŸ‘“",label:"çœ¼é•œ",cat:"clothes"},
    {id:"clo_mask",emoji:"ğŸ˜·",label:"å£ç½©",cat:"clothes"},
    {id:"clo_cap2",emoji:"ğŸ©",label:"ç¤¼å¸½",cat:"clothes"},

    // å·¥å…· tools
    {id:"tool_wrench",emoji:"ğŸ”§",label:"æ‰³æ‰‹",cat:"tools"},
    {id:"tool_hammer",emoji:"ğŸ”¨",label:"é”¤å­",cat:"tools"},
    {id:"tool_screwdriver",emoji:"ğŸª›",label:"èºä¸åˆ€",cat:"tools"},
    {id:"tool_saw",emoji:"ğŸªš",label:"é”¯å­",cat:"tools"},
    {id:"tool_scissors",emoji:"âœ‚ï¸",label:"å‰ªåˆ€",cat:"tools"},
    {id:"tool_broom",emoji:"ğŸ§¹",label:"æ‰«æŠŠ",cat:"tools"},
    {id:"tool_mop",emoji:"ğŸ§½",label:"æŠ¹å¸ƒ",cat:"tools"},
    {id:"tool_bucket",emoji:"ğŸª£",label:"æ°´æ¡¶",cat:"tools"},
    {id:"tool_pan",emoji:"ğŸ³",label:"å¹³åº•é”…",cat:"tools"},
    {id:"tool_pot",emoji:"ğŸ²",label:"æ±¤é”…",cat:"tools"},
    {id:"tool_knife",emoji:"ğŸ”ª",label:"åˆ€",cat:"tools"},
    {id:"tool_spoon",emoji:"ğŸ¥„",label:"å‹ºå­",cat:"tools"},
    {id:"tool_fork",emoji:"ğŸ´",label:"å‰å­",cat:"tools"},
    {id:"tool_flashlight",emoji:"ğŸ”¦",label:"æ‰‹ç”µ",cat:"tools"},
    {id:"tool_plug",emoji:"ğŸ”Œ",label:"æ’å¤´",cat:"tools"},
    {id:"tool_key",emoji:"ğŸ”‘",label:"é’¥åŒ™",cat:"tools"},
    {id:"tool_lock",emoji:"ğŸ”’",label:"é”",cat:"tools"},
    {id:"tool_phone",emoji:"ğŸ“±",label:"æ‰‹æœº",cat:"tools"},
    {id:"tool_remote",emoji:"ğŸ“º",label:"é¥æ§å™¨",cat:"tools"},
    {id:"tool_book",emoji:"ğŸ“–",label:"ä¹¦",cat:"tools"},
    {id:"tool_pencil",emoji:"âœï¸",label:"é“…ç¬”",cat:"tools"},
    {id:"tool_ruler",emoji:"ğŸ“",label:"å°ºå­",cat:"tools"},
    {id:"tool_tape",emoji:"ğŸ§»",label:"çº¸å·¾",cat:"tools"},
    {id:"tool_bag",emoji:"ğŸ›ï¸",label:"è´­ç‰©è¢‹",cat:"tools"}
  ]
};

let state={
  level:20,
  score:0,
  placed:new Set(),
  binContents:{},
  picked:[]
};

const itemsWrap=document.getElementById("itemsWrap");
const binsWrap=document.getElementById("binsWrap");
const msg=document.getElementById("msg");

function shuffle(a){
  // Fisher-Yates æ›´ç¨³å®š
  const arr = a.slice();
  for(let i=arr.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]]=[arr[j],arr[i]];
  }
  return arr;
}

function newRound(){
  state.score=0;
  state.placed.clear();
  state.binContents={};

  const picked = shuffle(SET.items).slice(0, Math.min(state.level, SET.items.length));
  state.picked = picked;

  render();
  msg.textContent="å¼€å§‹å§ ğŸ™‚";
}

function render(){
  itemsWrap.innerHTML="";
  binsWrap.innerHTML="";

  // ç‰©å“åŒºï¼šæ”¾è¿›å»ååŸä½è…¾ç©ºï¼ˆå ä½ç¬¦ï¼‰
  state.picked.forEach(it=>{
    const div=document.createElement("div");
    if(state.placed.has(it.id)){
      div.className="item placeholder";
    }else{
      div.className="item";
      div.innerHTML=`<div class="emoji">${it.emoji}</div><div class="label">${it.label}</div>`;
      enableDrag(div,it);
    }
    itemsWrap.appendChild(div);
  });

  // ç¯®å­åŒºï¼šæ˜¾ç¤ºå·²æ”¾å…¥çš„ç‰©å“
  SET.bins.forEach(bin=>{
    const b=document.createElement("div");
    b.className="bin";
    b.dataset.id=bin.id;
    b.innerHTML=`
      <div class="binName">${bin.title}</div>
      <div class="binHint">${bin.hint}</div>
      <div class="binItems"></div>
    `;
    (state.binContents[bin.id]||[]).forEach(it=>{
      const chip=document.createElement("div");
      chip.className="chip";
      chip.textContent=`${it.emoji} ${it.label}`;
      b.querySelector(".binItems").appendChild(chip);
    });
    binsWrap.appendChild(b);
  });

  document.getElementById("done").textContent=state.placed.size;
  document.getElementById("total").textContent=state.picked.length;
  document.getElementById("score").textContent=state.score;
}

function enableDrag(el,item){
  el.onpointerdown=e=>{
    el.setPointerCapture(e.pointerId);

    const ghost=el.cloneNode(true);
    ghost.style.position="fixed";
    ghost.style.left=(e.clientX+8)+"px";
    ghost.style.top=(e.clientY+8)+"px";
    ghost.style.opacity=".85";
    ghost.style.zIndex="9999";
    ghost.style.pointerEvents="none";
    document.body.appendChild(ghost);

    document.onpointermove=ev=>{
      ghost.style.left=(ev.clientX+8)+"px";
      ghost.style.top=(ev.clientY+8)+"px";
    };

    document.onpointerup=ev=>{
      document.onpointermove=null;
      document.onpointerup=null;
      ghost.remove();

      const bins = Array.from(document.querySelectorAll(".bin"));
      let dropped = false;

      for(const b of bins){
        const r=b.getBoundingClientRect();
        const hit = ev.clientX>r.left && ev.clientX<r.right && ev.clientY>r.top && ev.clientY<r.bottom;
        if(!hit) continue;

        dropped = true;

        if(b.dataset.id===item.cat){
          state.placed.add(item.id);
          state.score++;
          state.binContents[b.dataset.id] ??= [];
          state.binContents[b.dataset.id].push(item);
          msg.textContent="å¯¹å•¦ï½";
          render();

          if(state.placed.size === state.picked.length){
            msg.textContent="è¿™ä¸€ç»„å®Œæˆå•¦ ğŸ‰ ç‚¹â€œæ¢ä¸€ç»„â€ç»§ç»­ã€‚";
          }
        }else{
          msg.textContent="æ¢ä¸ªç¯®å­è¯•è¯•ï½";
        }
        break;
      }

      if(!dropped){
        msg.textContent="æ²¡å…³ç³»ï¼Œå†æ‹–ä¸€æ¬¡ï½";
      }
    };
  };
}

document.getElementById("btnNew").onclick=newRound;
document.getElementById("btnReset").onclick=newRound;

document.getElementById("levelSel").onchange=e=>{
  state.level=Number(e.target.value);
  newRound();
};

// åˆå§‹å€¼ï¼ˆé€‚ä¸­ 20ï¼‰
state.level = Number(document.getElementById("levelSel").value);
newRound();
</script>

</body>
</html>
